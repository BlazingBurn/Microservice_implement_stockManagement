import pyodbc
from sqlalchemy import create_engine
import urllib
from flask import Flask
from flask_sqlalchemy import SQLAlchemy



app = Flask(__name__)
app.config['SECRET_KEY'] = '323b22caac41acbf'
app.config['SQLALCHEMY'] = 'sqlite:///site.db'
db = SQLAlchemy(app)

params = urllib.parse.quote_plus \ # urllib.parse.quote_plus for python 3
(r'Driver={ODBC Driver 18 for SQL Server};Server=tcp:stockmanagementserveur.database.windows.net,1433;Database=stockManagement;Uid=adminstockmanagement;Pwd={Qsdfghjklm12};Encrypt=yes;TrustServerCertificate=no;Connection Timeout=30;')
conn_str = 'mssql+pyodbc:///?odbc_connect={}'.format(params)
db = create_engine(conn_str,echo=True)

print('connection is ok')
print(db.table_names())

from flaskinventory import routes

db.create_all()
db.session.commit()
